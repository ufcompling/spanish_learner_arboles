import os
from conllu import parse_incr
from collections import Counter

folder_path = "/Users/emi/Desktop/spanish_learner_arboles-main/annotated_essays"

#counters for the POS tags and the deprel labels
pos_counter = Counter()
dep_counter = Counter()

#loop through each conllu file in the annotated_essays folder
for filename in os.listdir(folder_path):
    if filename.endswith(".conllu"):
        file_path = os.path.join(folder_path, filename)
        with open(file_path, "r", encoding="utf-8") as f:
            for tokenlist in parse_incr(f):
                for token in tokenlist:
                    if isinstance(token["id"], int):  #skip multiword tokens
                        pos_counter[token["upostag"]] += 1
                        label = token["deprel"].lower()
                        dep_counter[label] += 1

print("POS tag frequencies:")
for tag, count in pos_counter.most_common():
    print(f"{tag}: {count}")

print("\nDependency label frequencies:")
for dep, count in dep_counter.most_common():
    print(f"{dep}: {count}")
